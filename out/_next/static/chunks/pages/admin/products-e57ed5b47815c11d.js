(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8209],{5408:function(t,e,r){"use strict";var n=r(7294),o=r(1163),a=r(6262),i=r(8344),c=r(1664),s=r.n(c),l=r(6501),u=r(5893);function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}e.Z=function(t){var e,r=t.children,c=(0,o.useRouter)(),d=(0,a.a)(),h=d.user,p=d.logout,m=d.loading,y=function(t){if(Array.isArray(t))return t}(e=(0,n.useState)(!1))||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],s=!0,l=!1;try{for(a=(r=r.call(t)).next;!(s=(n=a.call(r)).done)&&(c.push(n.value),2!==c.length);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(e,2)||function(t,e){if(t){if("string"==typeof t)return f(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(t,2)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),g=y[0],x=y[1];(0,n.useEffect)(function(){m||null!=h&&h.isAdmin||(l.ZP.error("You don't have permission to access this page."),c.push("/login"))},[h,m,c]);var v=[{name:"Dashboard",icon:(0,u.jsx)(i.P31,{}),href:"/admin/dashboard"},{name:"Products",icon:(0,u.jsx)(i.AFA,{}),href:"/admin/products"},{name:"Stores",icon:(0,u.jsx)(i.KSn,{}),href:"/admin/stores"},{name:"Categories",icon:(0,u.jsx)(i.YxP,{}),href:"/admin/categories"},{name:"Users",icon:(0,u.jsx)(i.I$,{}),href:"/admin/users"},{name:"Captains",icon:(0,u.jsx)(i.KE5,{}),href:"/admin/captains"},{name:"Settings",icon:(0,u.jsx)(i.p4t,{}),href:"/admin/settings"}],b=function(){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"h-20 flex items-center justify-center text-2xl font-bold text-white border-b border-gray-800",children:"Admin"}),(0,u.jsx)("nav",{className:"flex-1 px-4 py-8",children:(0,u.jsx)("ul",{children:v.map(function(t){return(0,u.jsx)("li",{className:"mb-2",children:(0,u.jsx)(s(),{href:t.href,children:(0,u.jsxs)("a",{className:"flex items-center p-3 rounded-lg transition-colors ".concat(c.pathname===t.href?"bg-indigo-600 text-white":"hover:bg-gray-800"),children:[(0,u.jsx)("span",{className:"mr-4 text-lg",children:t.icon}),t.name]})})},t.name)})})}),(0,u.jsx)("div",{className:"p-4 border-t border-gray-800",children:(0,u.jsxs)("button",{onClick:p,className:"w-full flex items-center p-3 rounded-lg text-left hover:bg-red-800 transition-colors",children:[(0,u.jsx)(i.fHX,{className:"mr-4"})," Logout"]})})]})};return m||!(null!=h&&h.isAdmin)?(0,u.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-100",children:(0,u.jsx)("p",{className:"text-gray-600",children:"Verifying access..."})}):(0,u.jsxs)("div",{className:"flex h-screen bg-gray-50 font-sans",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-gray-900 text-gray-200 flex flex-col z-50 transition-transform transform ".concat(g?"translate-x-0":"-translate-x-full"," md:hidden"),children:(0,u.jsx)(b,{})}),(0,u.jsx)("aside",{className:"w-64 bg-gray-900 text-gray-200 flex-col hidden md:flex",children:(0,u.jsx)(b,{})}),(0,u.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,u.jsxs)("header",{className:"h-20 bg-white shadow-sm flex items-center justify-between px-4 md:px-8 border-b",children:[(0,u.jsx)("button",{className:"md:hidden",onClick:function(){return x(!g)},children:g?(0,u.jsx)(i.aHS,{size:24}):(0,u.jsx)(i.Fm7,{size:24})}),(0,u.jsx)("h1",{className:"text-xl md:text-2xl font-semibold text-gray-800",children:"Admin Panel"}),(0,u.jsxs)("div",{className:"text-right",children:[(0,u.jsx)("p",{className:"font-semibold text-gray-800",children:null==h?void 0:h.name}),(0,u.jsx)("p",{className:"text-sm text-gray-500",children:null==h?void 0:h.email})]})]}),(0,u.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto p-4 md:p-8",children:r})]})]})}},2720:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return I}});var n=r(7294),o=r(5408),a=r(8735),i=r(670),c=r(109),s=r(6650),l=r(6501),u=r(5440),f=r(5675),d=r.n(f),h=r(5893);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(){m=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(e,r,n,a){var i,c,s=Object.create((r&&r.prototype instanceof x?r:x).prototype);return o(s,"_invoke",{value:(i=new k(a||[]),c=d,function(r,o){if(c===h)throw Error("Generator is already running");if(c===y){if("throw"===r)throw o;return{value:t,done:!0}}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var s=function e(r,n){var o=n.method,a=r.iterator[o];if(a===t)return n.delegate=null,"throw"===o&&r.iterator.return&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+o+"' method")),g;var i=f(a,r.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var c=i.arg;return c?c.done?(n[r.resultName]=c.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):c:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,g)}(a,i);if(s){if(s===g)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===d)throw c=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=h;var l=f(e,n,i);if("normal"===l.type){if(c=i.done?y:"suspendedYield",l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(c=y,i.method="throw",i.arg=l.arg)}})}),s}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",h="executing",y="completed",g={};function x(){}function v(){}function b(){}var j={};l(j,i,function(){return this});var w=Object.getPrototypeOf,N=w&&w(w(_([])));N&&N!==r&&n.call(N,i)&&(j=N);var S=b.prototype=x.prototype=Object.create(j);function E(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function P(t,e){var r;o(this,"_invoke",{value:function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==p(u)&&n.call(u,"__await")?e.resolve(u.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(u).then(function(t){l.value=t,i(l)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}})}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw TypeError(p(e)+" is not iterable")}return v.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(P.prototype),l(P.prototype,c,function(){return this}),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new P(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(S),l(S,s,"Generator"),l(S,i,function(){return this}),l(S,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function y(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){r(t);return}c.done?e(s):Promise.resolve(s).then(n,o)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var x=function(t){var e,r,o,f=t.onEdit,p=(0,a.r)(),x=p.products,v=p.loading,b=p.error,j=function(t){if(Array.isArray(t))return t}(e=(0,n.useState)(""))||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],s=!0,l=!1;try{for(a=(r=r.call(t)).next;!(s=(n=a.call(r)).done)&&(c.push(n.value),2!==c.length);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(e,2)||function(t,e){if(t){if("string"==typeof t)return g(t,2);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(t,2)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),w=j[0],N=j[1],S=(r=m().mark(function t(e){var r,n,o;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.confirm('Are you sure you want to delete "'.concat(e.name,'"? This action cannot be undone.'))){t.next=1;break}return t.abrupt("return");case 1:return t.prev=1,t.next=2,(0,c.oe)((0,c.JU)(i.db,"stores",e.storeId,"products",e.id));case 2:return r=(0,s.iH)(i.t,"products/".concat(e.id)),t.next=3,(0,s.aF)(r);case 3:return n=t.sent.items.map(function(t){return(0,s.oq)(t)}),t.next=4,Promise.all(n);case 4:l.ZP.success("Product and its images deleted successfully!"),t.next=6;break;case 5:t.prev=5,o=t.catch(1),l.ZP.error("Failed to delete product."),console.error("Error deleting product:",o);case 6:case"end":return t.stop()}},t,null,[[1,5]])}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var a=r.apply(t,e);function i(t){y(a,n,o,i,c,"next",t)}function c(t){y(a,n,o,i,c,"throw",t)}i(void 0)})},function(t){return o.apply(this,arguments)}),E=x.filter(function(t){return t.name.toLowerCase().includes(w.toLowerCase())});return v?(0,h.jsx)("p",{className:"text-gray-500 text-center py-10",children:"Loading products..."}):b?(0,h.jsx)("p",{className:"text-red-500 text-center py-10",children:"Error loading products."}):(0,h.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm",children:[(0,h.jsx)("div",{className:"p-4 flex justify-between items-center",children:(0,h.jsxs)("div",{className:"relative",children:[(0,h.jsx)(u.jRj,{className:"absolute top-1/2 -translate-y-1/2 left-3 text-gray-400"}),(0,h.jsx)("input",{type:"text",placeholder:"Search products...",value:w,onChange:function(t){return N(t.target.value)},className:"pl-10 pr-4 py-2 border border-gray-200 rounded-full focus:ring-2 focus:ring-blue-400 focus:outline-none"})]})}),(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)("table",{className:"w-full table-auto",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{className:"bg-gray-50",children:[(0,h.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Product"}),(0,h.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),(0,h.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,h.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),(0,h.jsx)("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,h.jsx)("tbody",{className:"divide-y divide-gray-200",children:E.map(function(t){var e;return(0,h.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,h.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("div",{className:"flex-shrink-0 h-12 w-12",children:(0,h.jsx)(d(),{src:(null===(e=t.imageUrls)||void 0===e?void 0:e[0])||"/placeholder.png",alt:t.name,width:48,height:48,className:"rounded-lg object-cover"})}),(0,h.jsxs)("div",{className:"ml-4",children:[(0,h.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.name}),(0,h.jsx)("div",{className:"text-sm text-gray-500",children:t.category})]})]})}),(0,h.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:["₹",t.price]}),(0,h.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:t.stock}),(0,h.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,h.jsx)("span",{className:"px-2.5 py-0.5 text-xs font-medium rounded-full ".concat(t.stock>0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.stock>0?"In Stock":"Out of Stock"})}),(0,h.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,h.jsx)("button",{onClick:function(){return f(t)},className:"text-blue-600 hover:text-blue-800 mr-4",children:(0,h.jsx)(u.vPQ,{size:18})}),(0,h.jsx)("button",{onClick:function(){return S(t)},className:"text-red-600 hover:text-red-800",children:(0,h.jsx)(u.Ybf,{size:18})})]})]},t.id)})})]})})]})},v=r(3880);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(){j=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(e,r,n,a){var i,c,s=Object.create((r&&r.prototype instanceof y?r:y).prototype);return o(s,"_invoke",{value:(i=new k(a||[]),c=d,function(r,o){if(c===h)throw Error("Generator is already running");if(c===p){if("throw"===r)throw o;return{value:t,done:!0}}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var s=function e(r,n){var o=n.method,a=r.iterator[o];if(a===t)return n.delegate=null,"throw"===o&&r.iterator.return&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+o+"' method")),m;var i=f(a,r.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var c=i.arg;return c?c.done?(n[r.resultName]=c.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):c:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,m)}(a,i);if(s){if(s===m)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===d)throw c=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=h;var l=f(e,n,i);if("normal"===l.type){if(c=i.done?p:"suspendedYield",l.arg===m)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(c=p,i.method="throw",i.arg=l.arg)}})}),s}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",h="executing",p="completed",m={};function y(){}function g(){}function x(){}var v={};l(v,i,function(){return this});var w=Object.getPrototypeOf,N=w&&w(w(_([])));N&&N!==r&&n.call(N,i)&&(v=N);var S=x.prototype=y.prototype=Object.create(v);function E(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function P(t,e){var r;o(this,"_invoke",{value:function(o,a){function i(){return new e(function(r,i){!function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==b(u)&&n.call(u,"__await")?e.resolve(u.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(u).then(function(t){l.value=t,i(l)},function(t){return r("throw",t,i,c)})}c(s.arg)}(o,a,r,i)})}return r=r?r.then(i,i):i()}})}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw TypeError(b(e)+" is not iterable")}return g.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:g,configurable:!0}),g.displayName=l(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(P.prototype),l(P.prototype,c,function(){return this}),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new P(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(S),l(S,s,"Generator"),l(S,i,function(){return this}),l(S,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function w(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){r(t);return}c.done?e(s):Promise.resolve(s).then(n,o)}function N(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?N(Object(r),!0).forEach(function(e){E(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function E(t,e,r){var n;return(n=function(t,e){if("object"!==b(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==b(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"===b(n)?n:String(n))in t)?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],s=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||O(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){if(t){if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(t,e)}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var k=["image/jpeg","image/png","image/webp"],_=function(t){var e,r,o=t.product,a=t.onClose,f=P((0,n.useState)({name:"",description:"",mrp:"",price:"",category:"",stock:"",storeId:""}),2),p=f[0],m=f[1],y=P((0,n.useState)([]),2),g=y[0],x=y[1],b=(0,v.m)(),N=b.stores,_=b.loading,A=b.error,C=P((0,n.useState)([]),2),I=C[0],T=C[1],F=P((0,n.useState)([]),2),G=F[0],U=F[1],Z=P((0,n.useState)(!1),2),z=Z[0],Y=Z[1],M=P((0,n.useState)(0),2),q=M[0],D=M[1];(0,n.useEffect)(function(){return(0,c.cf)((0,c.hJ)(i.db,"categories"),function(t){x(t.docs.map(function(t){return S({id:t.id},t.data())}))})},[]),(0,n.useEffect)(function(){o&&(m({name:o.name||"",description:o.description||"",mrp:o.mrp||"",price:o.price||"",category:o.category||"",stock:o.stock||"",storeId:o.storeId||""}),U(o.imageUrls?[o.imageUrls[0]]:[]))},[o]);var J=function(t){var e=t.target,r=e.name,n=e.value;m(function(t){return S(S({},t),{},E({},r,n))})},R=function(t){T(function(e){return e.filter(function(e,r){return r!==t})})},B=function(t){U(function(e){return e.filter(function(e){return e!==t})})},$=(e=j().mark(function t(e){var r,n,u,f,d,h,m;return j().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),p.storeId){t.next=1;break}return l.ZP.error("Please select a store."),t.abrupt("return");case 1:if(!(0===I.length&&0===G.length)){t.next=2;break}return l.ZP.error("Please upload at least one product image."),t.abrupt("return");case 2:if(Y(!0),t.prev=3,r=o?(0,c.JU)(i.db,"stores",o.storeId,"products",o.id):(0,c.JU)((0,c.hJ)(i.db,"stores",p.storeId,"products")),n=G[0]||null,!(I.length>0)){t.next=5;break}return u=I[0],f=(0,s.iH)(i.t,"products/".concat(r.id,"/original_").concat(u.name)),d=(0,s.B0)(f,u),t.next=4,new Promise(function(t,e){d.on("state_changed",function(t){return D(t.bytesTransferred/t.totalBytes*100)},function(t){return e(t)},function(){return(0,s.Jt)(d.snapshot.ref).then(t)})});case 4:n=t.sent;case 5:if(h=S(S({},p),{},{mrp:Number(p.mrp),price:Number(p.price),stock:Number(p.stock),imageUrl:n,updatedAt:(0,c.Bt)()}),delete h.imageUrls,!o){t.next=7;break}return t.next=6,(0,c.r7)(r,h);case 6:l.ZP.success("Product updated successfully!"),t.next=9;break;case 7:return h.createdAt=(0,c.Bt)(),t.next=8,(0,c.pl)(r,h);case 8:l.ZP.success("Product added successfully!");case 9:a(),t.next=11;break;case 10:t.prev=10,m=t.catch(3),l.ZP.error("Failed to save product. Please try again."),console.error(m);case 11:return t.prev=11,Y(!1),t.finish(11);case 12:case"end":return t.stop()}},t,null,[[3,10,11,12]])}),r=function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(t){w(a,n,o,i,c,"next",t)}function c(t){w(a,n,o,i,c,"throw",t)}i(void 0)})},function(t){return r.apply(this,arguments)});return(0,h.jsx)("div",{className:"fixed inset-0 bg-black/50 flex justify-center items-center z-50 p-4",children:(0,h.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-2xl max-h-full overflow-y-auto",children:[(0,h.jsx)("h2",{className:"text-xl font-bold mb-6",children:o?"Edit Product":"Add New Product"}),(0,h.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Images"}),(0,h.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[G.map(function(t,e){return(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)(d(),{src:t,alt:"Product",width:100,height:100,className:"rounded-lg object-cover"}),(0,h.jsx)("button",{type:"button",onClick:function(){return B(t)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)(u.Ybf,{size:12})})]},e)}),I.map(function(t,e){return(0,h.jsxs)("div",{className:"relative group",children:[(0,h.jsx)(d(),{src:URL.createObjectURL(t),alt:"Preview",width:100,height:100,className:"rounded-lg object-cover"}),(0,h.jsx)("button",{type:"button",onClick:function(){return R(e)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,h.jsx)(u.Ybf,{size:12})})]},e)}),(0,h.jsxs)("label",{className:"w-full h-24 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,h.jsx)(u.Re4,{className:"text-gray-400 text-2xl"}),(0,h.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"}),(0,h.jsx)("input",{type:"file",multiple:!0,onChange:function(t){if(t.target.files){for(var e=Array.from(t.target.files),r=[],n=0;n<e.length;n++){var o=e[n];if(o.size>5242880){l.ZP.error('File "'.concat(o.name,'" is too large. Max size is ').concat(5,"MB."));continue}if(!k.includes(o.type)){l.ZP.error('File type for "'.concat(o.name,'" is not supported.'));continue}r.push(o)}T(function(t){return[].concat(function(t){if(Array.isArray(t))return L(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||O(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r)})}},className:"hidden",accept:k.join(",")})]})]})]}),(0,h.jsx)("input",{type:"text",name:"name",value:p.name,onChange:J,placeholder:"Product Name",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400",required:!0}),(0,h.jsx)("textarea",{name:"description",value:p.description,onChange:J,placeholder:"Product Description",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400",rows:"3"}),(0,h.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,h.jsx)("input",{type:"number",name:"mrp",value:p.mrp,onChange:J,placeholder:"MRP (₹)",className:"w-full p-3 border rounded-lg",required:!0}),(0,h.jsx)("input",{type:"number",name:"price",value:p.price,onChange:J,placeholder:"Selling Price (₹)",className:"w-full p-3 border rounded-lg",required:!0}),(0,h.jsx)("input",{type:"number",name:"stock",value:p.stock,onChange:J,placeholder:"Stock",className:"w-full p-3 border rounded-lg",required:!0})]}),(0,h.jsxs)("select",{name:"storeId",value:p.storeId,onChange:J,className:"w-full p-3 border rounded-lg",required:!0,disabled:_,children:[(0,h.jsx)("option",{value:"",children:_?"Loading stores...":A?"Error loading stores":"Select a Store"}),!_&&!A&&N.map(function(t){return(0,h.jsx)("option",{value:t.id,children:t.name},t.id)})]}),(0,h.jsxs)("select",{name:"category",value:p.category,onChange:J,className:"w-full p-3 border rounded-lg",required:!0,children:[(0,h.jsx)("option",{value:"",children:"Select a Category"}),g.map(function(t){return(0,h.jsx)("option",{value:t.name,children:t.name},t.id)})]}),z&&(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,h.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(q,"%")}})}),(0,h.jsxs)("div",{className:"flex justify-end gap-4 pt-4",children:[(0,h.jsx)("button",{type:"button",onClick:a,className:"py-2 px-5 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,h.jsx)("button",{type:"submit",disabled:z||_,className:"py-2 px-5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:z?"Saving...":"Save Product"})]})]})]})})};function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],s=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return C(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var I=function(){var t=A((0,n.useState)(!1),2),e=t[0],r=t[1],a=A((0,n.useState)(null),2),i=a[0],c=a[1],s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(t),r(!0)};return(0,h.jsxs)(o.Z,{children:[(0,h.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,h.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Manage Products"}),(0,h.jsxs)("button",{onClick:function(){return s()},className:"flex items-center bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:[(0,h.jsx)(u.OvN,{className:"mr-2"}),"Create Product"]})]}),(0,h.jsx)(x,{onEdit:s})]}),e&&(0,h.jsx)(_,{product:i,onClose:function(){r(!1),c(null)}})]})}},2678:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/products",function(){return r(2720)}])}},function(t){t.O(0,[3365,6130,4253,5675,8735,2888,9774,179],function(){return t(t.s=2678)}),_N_E=t.O()}]);